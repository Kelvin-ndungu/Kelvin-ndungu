% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Van Analysis},
  pdfauthor={Kelvin N. Kinyanjui},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Van Analysis}
\author{Kelvin N. Kinyanjui}
\date{2022-07-13}

\begin{document}
\maketitle

\hypertarget{business-problem}{%
\section{Business Problem}\label{business-problem}}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

The client owns a business that maintains a lot of vans.

The client provided an spreadsheet file with \emph{Engine
Type},\emph{Mileage}, \emph{Service Date}, \emph{Cost of repair}, and
\emph{Van
Number}.\href{https://docs.google.com/spreadsheets/d/11zPiOVSR7AlZEzn0jGHPik0ISszIb5w7rFvrMT7P8pQ/edit?usp=sharing}{Shared
File}

The client required me as a data analyst, to visualize the data in a
manner that will enable them to determine \textbf{at what point are the
vans too expensive to maintain and needs to be sold}.

\hypertarget{data-preparation-manipulation-and-analysis}{%
\section{Data Preparation, Manipulation, and
Analysis}\label{data-preparation-manipulation-and-analysis}}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{setting-up-my-environement}{%
\subsection{Setting Up my
environement}\label{setting-up-my-environement}}

Installing and loading all the packages that will be used in this
project.

\begin{itemize}
\tightlist
\item
  Tidyverse:

  \begin{itemize}
  \tightlist
  \item
    readxl
  \item
    dplyr
  \item
    ggplot2
  \item
    tidyr\\
  \end{itemize}
\item
  Lubridate
\end{itemize}

\begin{quote}
install.packages(``tidyverse'') \# For data analysis and visualization\\
install.packages(``lubridate'') \# For working with dates\\
install.packages(``janitor'')\\
library(tidyverse)\\
library(lubridate)\\
library(janitor) library(tidyr) library(dplyr) library(readxl)
library(ggplot2)
\end{quote}

Loading vans data from Google sheets using googlesheets4::read\_sheet()
function

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{raw\_data }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_xlsx}\NormalTok{(}\StringTok{"Van\_Mileage.xlsx"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(raw\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   `VEH. TYPE`    MILEAGE DATE                TOTAL `VAN #`
##   <chr>            <dbl> <dttm>              <dbl> <chr>  
## 1 GC 3.6L         136049 2019-08-14 00:00:00 670.  VAN 12 
## 2 PROMASTER 3.6L   72369 2019-08-19 00:00:00  31.5 VAN 21 
## 3 GC 3.6L         179931 2019-08-21 00:00:00 330.  VAN 14 
## 4 GC 3.6L          42182 2019-08-25 00:00:00  78   VAN 25 
## 5 TRANSIT 3.7L    145079 2019-09-06 00:00:00 235.  VAN 19 
## 6 GC 3.6L          79162 2019-09-09 00:00:00  33.1 VAN 20
\end{verbatim}

Renaming column heads with readable words

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#assign the raw data to a new variable}
\NormalTok{van\_data }\OtherTok{\textless{}{-}}\NormalTok{ raw\_data }

\CommentTok{\#use a janitor package function to clean column names ensuring column names contains only numbers, characters \& letters}
\NormalTok{van\_data }\OtherTok{\textless{}{-}}\NormalTok{ janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{(van\_data)}

\CommentTok{\#view the column names}
\FunctionTok{colnames}\NormalTok{(van\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "veh_type"   "mileage"    "date"       "total"      "van_number"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#change the column names to be more descriptive}
\NormalTok{van\_data }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{rename}\NormalTok{(van\_data, }\AttributeTok{engine\_type =} \StringTok{"veh\_type"}\NormalTok{, }\AttributeTok{service\_date =} \StringTok{"date"}\NormalTok{, }\AttributeTok{total\_cost =} \StringTok{"total"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(van\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   engine_type    mileage service_date        total_cost van_number
##   <chr>            <dbl> <dttm>                   <dbl> <chr>     
## 1 GC 3.6L         136049 2019-08-14 00:00:00      670.  VAN 12    
## 2 PROMASTER 3.6L   72369 2019-08-19 00:00:00       31.5 VAN 21    
## 3 GC 3.6L         179931 2019-08-21 00:00:00      330.  VAN 14    
## 4 GC 3.6L          42182 2019-08-25 00:00:00       78   VAN 25    
## 5 TRANSIT 3.7L    145079 2019-09-06 00:00:00      235.  VAN 19    
## 6 GC 3.6L          79162 2019-09-09 00:00:00       33.1 VAN 20
\end{verbatim}

Summarizing data to get an overview and while evaluating for
inconsistencies

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#sorting van\_data in ascending order using mileage}
\NormalTok{van\_data }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{arrange}\NormalTok{(van\_data, mileage)}
\FunctionTok{head}\NormalTok{(van\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   engine_type  mileage service_date        total_cost van_number
##   <chr>          <dbl> <dttm>                   <dbl> <chr>     
## 1 GC 3.6L           36 2021-04-12 00:00:00     1341.  VAN N06   
## 2 GC 3.6L           60 2021-05-28 00:00:00      842.  VAN N14   
## 3 TRANSIT 3.5L      60 2021-05-28 00:00:00      578.  VAN N04   
## 4 TRANSIT 3.5L      70 2021-06-18 00:00:00      681.  VAN N05   
## 5 VOYAGER 3.6L     450 2021-09-13 00:00:00       32.5 VAN N15   
## 6 GC 3.6L          520 2021-05-28 00:00:00       97.5 VAN 14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The nested code below can also be expressed using pipes}

\CommentTok{\# vans\_per\_engine \textless{}{-} van\_data \%\textgreater{}\% }
\CommentTok{\#   dplyr::group\_by(engine\_type) \%\textgreater{}\% }
\CommentTok{\#   dplyr::summarize(max\_mileage = max(mileage), min\_mileage = min(mileage), unique\_vans = dplyr::n\_distinct(van\_number))}

\CommentTok{\#getting a high level summary of the data}
\NormalTok{vans\_per\_engine\_type }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{((dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(van\_data, engine\_type)), }\AttributeTok{max\_mileage =} \FunctionTok{max}\NormalTok{(mileage), }\AttributeTok{min\_mileage =} \FunctionTok{min}\NormalTok{(mileage), }\AttributeTok{unique\_vans =}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{n\_distinct}\NormalTok{(van\_number))}
\FunctionTok{head}\NormalTok{(vans\_per\_engine\_type)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
##   engine_type    max_mileage min_mileage unique_vans
##   <chr>                <dbl>       <dbl>       <int>
## 1 E150 4.6L           258500       16699           1
## 2 GC 3.6L             511155          36          15
## 3 PROMASTER 3.6L      249097        2200           8
## 4 TRANSIT 3.5L         38888          60           2
## 5 TRANSIT 3.7L        283567        4600           5
## 6 VOYAGER 3.6L         35462         450           1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Getting a summary for each van}
\CommentTok{\# vans\_summary \textless{}{-} van\_data \%\textgreater{}\% }
\CommentTok{\#   dplyr::group\_by(engine\_type, van\_number) \%\textgreater{}\% }
\CommentTok{\#   dplyr::summarize(max\_mileage = max(mileage), min\_mileage = min(mileage), number\_of\_service\_times = dplyr::n\_distinct(service\_date), total\_service\_cost = sum(total\_cost) )}
\CommentTok{\# View(vans\_summary)}
\CommentTok{\# head(vans\_summary)}

\NormalTok{vans\_summary }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{((dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(van\_data, engine\_type, van\_number)), }\AttributeTok{max\_mileage =} \FunctionTok{max}\NormalTok{(mileage), }\AttributeTok{min\_mileage =} \FunctionTok{min}\NormalTok{(mileage), }\AttributeTok{number\_of\_service\_times =}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{n\_distinct}\NormalTok{(service\_date), }\AttributeTok{total\_service\_cost =} \FunctionTok{sum}\NormalTok{(total\_cost) )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'engine_type'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(vans\_summary)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 6
## # Groups:   engine_type [2]
##   engine_type van_number max_mileage min_mileage number_of_service_times
##   <chr>       <chr>            <dbl>       <dbl>                   <int>
## 1 E150 4.6L   VAN 02          258500       16699                      29
## 2 GC 3.6L     VAN 07          183223      136137                      34
## 3 GC 3.6L     VAN 09          218641      169604                      21
## 4 GC 3.6L     VAN 10          198376      120936                      24
## 5 GC 3.6L     VAN 11          201951      146858                      29
## 6 GC 3.6L     VAN 12          292289      136049                      49
## # ... with 1 more variable: total_service_cost <dbl>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#View(vans\_summary)}
\end{Highlighting}
\end{Shaded}

\hypertarget{data-cleaning-and-data-validation}{%
\subsection{Data Cleaning and Data
Validation}\label{data-cleaning-and-data-validation}}

From the summary above, there are noticeable inconsistencies in the
data.\\
1. Inconsistent naming in the van\_number column\\
2. There are 32 observations despite the last van being listed as van
30. After evaluation there are two Van9s (Van N09 and Van 09) and two
Van14s (Van 14 \&Van N14).

In this case, visualizing the two observations: van9s and van14s.

Filtering data to only show the two variations of van 09 and Van 14.

\begin{Shaded}
\begin{Highlighting}[]
 \CommentTok{\# Filtering the data}
\NormalTok{van\_9s }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data, van\_number}\SpecialCharTok{==} \StringTok{"VAN 09"} \SpecialCharTok{|}\NormalTok{ van\_number}\SpecialCharTok{==} \StringTok{"VAN N09"}\NormalTok{)}
\NormalTok{van\_14s }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data, van\_number}\SpecialCharTok{==} \StringTok{"VAN 14"} \SpecialCharTok{|}\NormalTok{ van\_number}\SpecialCharTok{==} \StringTok{"VAN N14"}\NormalTok{)}

\FunctionTok{head}\NormalTok{(van\_9s)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   engine_type  mileage service_date        total_cost van_number
##   <chr>          <dbl> <dttm>                   <dbl> <chr>     
## 1 TRANSIT 3.7L   24970 2021-11-18 00:00:00      118.  VAN N09   
## 2 TRANSIT 3.7L   27000 2021-11-29 00:00:00      194.  VAN N09   
## 3 TRANSIT 3.7L   27250 2021-12-16 00:00:00      964.  VAN N09   
## 4 TRANSIT 3.7L   29100 2021-12-13 00:00:00       32.5 VAN N09   
## 5 TRANSIT 3.7L   30665 2021-12-20 00:00:00       75.2 VAN N09   
## 6 TRANSIT 3.7L   36614 2022-01-20 00:00:00      109.  VAN N09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#View(van\_9s)\#From this view one can tell that the vans are different because they have different engine types }

\FunctionTok{head}\NormalTok{(van\_14s)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   engine_type mileage service_date        total_cost van_number
##   <chr>         <dbl> <dttm>                   <dbl> <chr>     
## 1 GC 3.6L          60 2021-05-28 00:00:00      842.  VAN N14   
## 2 GC 3.6L         520 2021-05-28 00:00:00       97.5 VAN 14    
## 3 GC 3.6L        4065 2021-06-22 00:00:00       60.7 VAN N14   
## 4 GC 3.6L       12180 2021-08-10 00:00:00       60.7 VAN N14   
## 5 GC 3.6L       15000 2021-09-02 00:00:00       27.8 VAN 14    
## 6 GC 3.6L       18700 2021-09-29 00:00:00       60.7 VAN N14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#View(van\_14s)}
\CommentTok{\#dataframes for the ggplot2 plots}

\CommentTok{\#1. date\_breaks for setting the breaks in the x axis dates}
\NormalTok{date\_breaks }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2019{-}06{-}01"}\NormalTok{), }\FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2022{-}06{-}01"}\NormalTok{), }\AttributeTok{by =} \StringTok{"6 month"}\NormalTok{)}

\CommentTok{\#plotting a scatter plot to visualize the data(van\_9s)}
\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(van\_9s) }\SpecialCharTok{+} 
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{mapping =}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{ mileage, }\AttributeTok{color =}\NormalTok{ van\_number, }\AttributeTok{shape=}\NormalTok{ van\_number)) }\SpecialCharTok{+}
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date"}\NormalTok{, }\AttributeTok{subtitle =} \StringTok{"Visualizing VAN 09 and VAN N09 to check for similarities or differences"}\NormalTok{, }\AttributeTok{caption =} \StringTok{"The two vans are different"}\NormalTok{ ) }\SpecialCharTok{+} 
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =}\DecValTok{25}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/compare van 9 \& 14-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#plotting a scatter plot to visualize the data(van\_14s).}

\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(van\_14s) }\SpecialCharTok{+} 
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{mapping =}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{ mileage, }\AttributeTok{color =}\NormalTok{ van\_number, }\AttributeTok{shape=}\NormalTok{ van\_number)) }\SpecialCharTok{+}
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+} 
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date"}\NormalTok{, }\AttributeTok{subtitle =} \StringTok{"Visualizing VAN 14 and VAN N14 to check for similarities or differences"}\NormalTok{, }\AttributeTok{caption =} \StringTok{"The two vans are different"}\NormalTok{ ) }\SpecialCharTok{+} 
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =}\DecValTok{25}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+} 
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{scale\_x\_datetime}\NormalTok{(}\AttributeTok{breaks =}\NormalTok{ date\_breaks)}\SpecialCharTok{+}\NormalTok{ ggrepel}\SpecialCharTok{::}\FunctionTok{geom\_text\_repel}\NormalTok{(ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(service\_date, mileage, }\AttributeTok{label=}\NormalTok{ mileage), }\AttributeTok{size=}\DecValTok{2}\NormalTok{)}\SpecialCharTok{+}
\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{annotate}\NormalTok{(}\StringTok{"rect"}\NormalTok{, }\AttributeTok{xmin =} \FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2020{-}03{-}01"}\NormalTok{), }\AttributeTok{xmax=} \FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2020{-}11{-}01"}\NormalTok{), }\AttributeTok{ymin =} \DecValTok{175000}\NormalTok{, }\AttributeTok{ymax =} \DecValTok{220000}\NormalTok{, }\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{1}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{ ) }\SpecialCharTok{+}
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x=} \FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2020{-}11{-}15"}\NormalTok{), }\AttributeTok{y=} \DecValTok{160000}\NormalTok{, }\AttributeTok{label =} \StringTok{"The last two scatter points are }\SpecialCharTok{\textbackslash{}n}\StringTok{ inconsistent with the other scatter points"}\NormalTok{, }\AttributeTok{size =}\DecValTok{3}\NormalTok{)}\SpecialCharTok{+}
\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x=} \FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2020{-}11{-}15"}\NormalTok{), }\AttributeTok{y=} \DecValTok{25000}\NormalTok{, }\AttributeTok{label =} \StringTok{"Some values of VAN N14 might }\SpecialCharTok{\textbackslash{}n}\StringTok{ have been recorded as VAN 14"}\NormalTok{, }\AttributeTok{size =}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/compare van 9 \& 14-2.pdf}

From the plot above, a number of things are ensued.\\
1. There are inconsistencies in the service\_dates and the recorded
mileage (Will be handled in the next step)\\
2. VAN N09 can be changed to van 31\\
3. VAN N14 can be changed to VAN 14 to VAN 32\\
4. Client gave a go ahead on changing the VAN 14 observations with a
mileage below 50000 to Van32

\hypertarget{changing-observationsvan_number-for-consistency}{%
\subsubsection{Changing Observations(van\_number) for
consistency}\label{changing-observationsvan_number-for-consistency}}

First we need to replace VAN N09 with VAN 31 and VAN 14 with VAN32

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#assigning van\_data to another variable.  }
\CommentTok{\# The code below modifies the original data frame. Therefore, it is wise to assign it to another variable }
\NormalTok{van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ van\_data}

\CommentTok{\#modifying the observations that were recorded incorrectly }
\NormalTok{van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_number[van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_number}\SpecialCharTok{==}\StringTok{"VAN 14"}\SpecialCharTok{\&}\NormalTok{ van\_data\_32}\SpecialCharTok{$}\NormalTok{mileage }\SpecialCharTok{\textless{}} \DecValTok{50000}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"VAN N14"}

\CommentTok{\#modifying van numbers for two vans}
\NormalTok{van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_number[van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_number}\SpecialCharTok{==}\StringTok{"VAN N09"}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"VAN 31"}
\NormalTok{van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_number[van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_number}\SpecialCharTok{==}\StringTok{"VAN N14"}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"VAN 32"}

\CommentTok{\#visualizing the two  changed van numbers}
\CommentTok{\# testvan \textless{}{-}dplyr::filter(van\_data\_32, van\_number== "VAN 09" | van\_number== "VAN 31")}
\CommentTok{\# testvan2 \textless{}{-}dplyr::filter(van\_data\_32, van\_number== "VAN 14" | van\_number== "VAN 32")}
\CommentTok{\# ggplot2::ggplot(data =testvan ) + ggplot2::geom\_point(mapping = ggplot2::aes(x= service\_date, y=mileage,color = van\_number))}
\CommentTok{\# ggplot2::ggplot(data =testvan2 ) + ggplot2::geom\_line(mapping = ggplot2::aes(x= service\_date, y=mileage,color = van\_number)) +ggplot2::facet\_wrap(\textasciitilde{}engine\_type)}

\CommentTok{\#changing van\_numbers names for consistency. }
\NormalTok{van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_no }\OtherTok{\textless{}{-}}\NormalTok{ stringr}\SpecialCharTok{::}\FunctionTok{str\_sub}\NormalTok{(van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_number, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{)}
\NormalTok{van\_data\_32}\SpecialCharTok{$}\NormalTok{van }\OtherTok{\textless{}{-}}\NormalTok{ stringr}\SpecialCharTok{::}\FunctionTok{str\_c}\NormalTok{(}\StringTok{"van\_"}\NormalTok{, van\_data\_32}\SpecialCharTok{$}\NormalTok{van\_no)}
\NormalTok{van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(van\_data\_32, van, engine\_type, mileage, service\_date, total\_cost)}
\FunctionTok{head}\NormalTok{(van\_data\_32)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   van    engine_type  mileage service_date        total_cost
##   <chr>  <chr>          <dbl> <dttm>                   <dbl>
## 1 van_06 GC 3.6L           36 2021-04-12 00:00:00     1341. 
## 2 van_32 GC 3.6L           60 2021-05-28 00:00:00      842. 
## 3 van_04 TRANSIT 3.5L      60 2021-05-28 00:00:00      578. 
## 4 van_05 TRANSIT 3.5L      70 2021-06-18 00:00:00      681. 
## 5 van_15 VOYAGER 3.6L     450 2021-09-13 00:00:00       32.5
## 6 van_32 GC 3.6L          520 2021-05-28 00:00:00       97.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#View(van\_data\_32)}
\end{Highlighting}
\end{Shaded}

\hypertarget{data-validation}{%
\subsubsection{Data Validation}\label{data-validation}}

It is expected that an increase in mileage should be accompanied by a
progression in Date.

Therefore, we will make plots per van for mileage against service date
to verify if the data is correct and detect any outliers.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Creating a broad visualization for all the vans}

\CommentTok{\#ggplot2::ggplot(data =van\_data\_32 ) + ggplot2::geom\_line(mapping = ggplot2::aes(x= service\_date, y=mileage,color = van)) +ggplot2::facet\_wrap(\textasciitilde{}engine\_type)}

\CommentTok{\# We can filter the data according to engine (combine engine\_types with few vans)}

\CommentTok{\# gc\_3.6l \textless{}{-} dplyr::filter(van\_data\_32, engine\_type== "GC 3.6L")}
\CommentTok{\# promaster \textless{}{-} dplyr::filter(van\_data\_32, engine\_type== "PROMASTER 3.6L")}
\CommentTok{\# other\_vans \textless{}{-} dplyr::filter(van\_data\_32, engine\_type != "GC 3.6L" \& engine\_type != "PROMASTER 3.6L")}

\CommentTok{\# ggplot2::ggplot(data =gc\_3.6l, ggplot2::aes(x= service\_date, y=mileage,color = van) ) + ggplot2::geom\_line() + ggplot2::geom\_point()  }
\CommentTok{\# }
\CommentTok{\# ggplot2::ggplot(data =promaster, ggplot2::aes(x= service\_date, y=mileage,color = van) ) + ggplot2::geom\_line() + ggplot2::geom\_point() }
\CommentTok{\# }

\CommentTok{\# ggplot2::ggplot(data =other\_vans, ggplot2::aes(x= service\_date, y=mileage,color = van) ) + ggplot2::geom\_line() + ggplot2::geom\_point() }

\CommentTok{\#deleting a row that does not meet a specific condition}
\CommentTok{\#van\_data\_32 \textless{}{-} van\_data\_32[!(van\_data\_32$van == "van\_02" \& van\_data\_32$mileage == 16699),]}

\CommentTok{\#van\_data\_32$service\_date[van\_data\_32$mileage == 19000 \& van\_data\_32$van == "van\_06"] \textless{}{-} as.POSIXct("2021{-}12{-}06")}


\NormalTok{van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{arrange}\NormalTok{(van\_data\_32, van, mileage)}
\FunctionTok{View}\NormalTok{(van\_data\_32)}
\end{Highlighting}
\end{Shaded}

\hypertarget{removing-outliersout-of-range-van_02}{%
\paragraph{Removing Outliers(out of range)
van\_02}\label{removing-outliersout-of-range-van_02}}

Some of the observations that were changed:

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0811}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.2703}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\centering
Van
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
service\_cost\_change
\end{minipage} \\
\midrule()
\endhead
van\_02 & 2020\_11\_23 & 16699 & removed & removed & -129.04 \\
van\_02 & 2020\_12\_23 & 213404 & not\_changed & 213440 & 572.87 \\
\bottomrule()
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#filtering data for each van, checking for outliers through a visualization, confirming with the client and modifying the values accordingly}

\CommentTok{\#van\_data\_32 \textless{}{-} dplyr::arrange(van\_data\_32, van, mileage)}
\CommentTok{\#View(van\_data\_32)}

\CommentTok{\#make changes and then filter the data out to verify that the changes have been effected}



\FunctionTok{head}\NormalTok{(van\_data\_32)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   van    engine_type  mileage service_date        total_cost
##   <chr>  <chr>          <dbl> <dttm>                   <dbl>
## 1 van_01 TRANSIT 3.7L    4600 2021-10-04 00:00:00       72.0
## 2 van_01 TRANSIT 3.7L   52300 2021-11-13 00:00:00      118. 
## 3 van_01 TRANSIT 3.7L   55000 2021-12-07 00:00:00      561. 
## 4 van_01 TRANSIT 3.7L   59500 2021-12-20 00:00:00      130. 
## 5 van_01 TRANSIT 3.7L   67000 2022-02-07 00:00:00       75.2
## 6 van_01 TRANSIT 3.7L   67100 2022-02-08 00:00:00      611.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ select\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_02"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_02 with outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van 2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
 \CommentTok{\#deleting a row that does not meet a specific condition}
 
\NormalTok{van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ van\_data\_32[}\SpecialCharTok{!}\NormalTok{(van\_data\_32}\SpecialCharTok{$}\NormalTok{van }\SpecialCharTok{==} \StringTok{"van\_02"} \SpecialCharTok{\&}\NormalTok{ van\_data\_32}\SpecialCharTok{$}\NormalTok{mileage }\SpecialCharTok{==} \DecValTok{16699}\NormalTok{),]}

\NormalTok{select\_van\_clean }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_02"}\NormalTok{)}
\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van\_clean, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_02 without outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van 2-2.pdf}

\hypertarget{removing-outliersout-of-range-in-van_12}{%
\paragraph{Removing Outliers(out of range) in
van\_12}\label{removing-outliersout-of-range-in-van_12}}

Some of the observations that were changed include:\\
\textbar{} Van \textbar Date \textbar mileage \textbar new\_date
\textbar new\_mileage\textbar{} service\_cost\_change\textbar{}\\
\textbar:----:\textbar:-----------:\textbar:---------:\textbar:-----------:\textbar:---------:\textbar:------------------:\textbar{}\\
\textbar van\_12\textbar2021\_02\_28 \textbar292289 \textbar removed
\textbar removed \textbar-58.14 \textbar{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ select\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_12"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_12 with outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van_12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
 \CommentTok{\#deleting a row that does not meet a specific condition}
 
\NormalTok{van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ van\_data\_32[}\SpecialCharTok{!}\NormalTok{(van\_data\_32}\SpecialCharTok{$}\NormalTok{van }\SpecialCharTok{==} \StringTok{"van\_12"} \SpecialCharTok{\&}\NormalTok{ van\_data\_32}\SpecialCharTok{$}\NormalTok{mileage }\SpecialCharTok{==} \DecValTok{292289}\NormalTok{),]}

\NormalTok{select\_van\_clean }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_12"}\NormalTok{)}
\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van\_clean, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_12 without outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van_12-2.pdf}

\hypertarget{removing-outliersout-of-range-from-van_16}{%
\paragraph{Removing Outliers(out of range) from
van\_16}\label{removing-outliersout-of-range-from-van_16}}

Some of the main changes included:

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0811}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.2703}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\centering
Van
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
service\_cost\_change
\end{minipage} \\
\midrule()
\endhead
van\_16 & 2021-10-15 & 511155 & removed & removed & -97.28 \\
\bottomrule()
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{select\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_16"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_16 with outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van_16-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  \#deleting a row that does not meet a specific condition}
\NormalTok{ van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ van\_data\_32[}\SpecialCharTok{!}\NormalTok{(van\_data\_32}\SpecialCharTok{$}\NormalTok{van }\SpecialCharTok{==} \StringTok{"van\_16"} \SpecialCharTok{\&}\NormalTok{ van\_data\_32}\SpecialCharTok{$}\NormalTok{mileage }\SpecialCharTok{==} \DecValTok{511155}\NormalTok{),]}
 
\NormalTok{ select\_van\_clean }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_16"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van\_clean, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_16 without outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van_16-2.pdf}

\hypertarget{cleaning-van_17}{%
\paragraph{Cleaning van\_17}\label{cleaning-van_17}}

Some of the main changes included:

\begin{longtable}[]{@{}cccccc@{}}
\toprule()
Van & Date & mileage & new\_date & new\_mileage & total\_cost \\
\midrule()
\endhead
- & - & - & - & - & - \\
\bottomrule()
\end{longtable}

van\_17 is a van of interest. Despite having an inconsistency, the
values are within the range. Therefore, the inconsistency will not be
removed.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{select\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_17"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{  ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_17 cleaning"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van_17-1.pdf}

\hypertarget{removing-outliers-out-0f-range-from-van_19}{%
\paragraph{Removing Outliers (out 0f range) from
Van\_19}\label{removing-outliers-out-0f-range-from-van_19}}

Some of the main changes included:

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0811}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.2703}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\centering
Van
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
service\_cost\_change
\end{minipage} \\
\midrule()
\endhead
van\_19 & 2021-11-03 & 26501 & removed & remove & -419.54 \\
& & & & & \\
\bottomrule()
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{select\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_19"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_19 with outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van_19-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  \#deleting a row that does not meet a specific condition}
\NormalTok{ van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ van\_data\_32[}\SpecialCharTok{!}\NormalTok{(van\_data\_32}\SpecialCharTok{$}\NormalTok{van }\SpecialCharTok{==} \StringTok{"van\_19"} \SpecialCharTok{\&}\NormalTok{ van\_data\_32}\SpecialCharTok{$}\NormalTok{mileage }\SpecialCharTok{==} \DecValTok{26501}\NormalTok{),]}
 
\NormalTok{ select\_van\_clean }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_19"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van\_clean, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_19 without outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van_19-2.pdf}

\hypertarget{removing-outliers-out-of-range-from-van-26}{%
\paragraph{Removing Outliers (out of range) from van
26}\label{removing-outliers-out-of-range-from-van-26}}

Some of the main changes included:\\
\textbar{} Van \textbar Date \textbar mileage \textbar new\_date
\textbar new\_mileage\textbar{} service\_cost\_change\textbar{}
\textbar:----:\textbar:-----------:\textbar:---------:\textbar:-----------:\textbar:---------:\textbar:------------------:\textbar{}
\textbar van\_26\textbar2021-08-02 \textbar184900 \textbar removed
\textbar removed \textbar{} 67.40 \textbar{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{select\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_26"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_26 with outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/Cleaning van_26-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#  \#deleting a row that does not meet a specific condition}
\NormalTok{ van\_data\_32 }\OtherTok{\textless{}{-}}\NormalTok{ van\_data\_32[}\SpecialCharTok{!}\NormalTok{(van\_data\_32}\SpecialCharTok{$}\NormalTok{van }\SpecialCharTok{==} \StringTok{"van\_26"} \SpecialCharTok{\&}\NormalTok{ van\_data\_32}\SpecialCharTok{$}\NormalTok{mileage }\SpecialCharTok{==} \DecValTok{184900}\NormalTok{),]}
 
\NormalTok{ select\_van\_clean }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_26"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van\_clean, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_19 without outlier(s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/Cleaning van_26-2.pdf}

\hypertarget{cleaning-van_27-van-of-intrest}{%
\paragraph{Cleaning van\_27 (van of
intrest)}\label{cleaning-van_27-van-of-intrest}}

Some of the main changes included:

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0811}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1757}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.2703}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\centering
Van
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_date
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
new\_mileage
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
service\_cost\_change
\end{minipage} \\
\midrule()
\endhead
& & & & & \\
\bottomrule()
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{select\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(van\_data\_32, van}\SpecialCharTok{==} \StringTok{"van\_27"}\NormalTok{)}
\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ select\_van, ggplot2}\SpecialCharTok{::}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ service\_date, }\AttributeTok{y=}\NormalTok{mileage,}\AttributeTok{color =}\NormalTok{ van) ) }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}\NormalTok{ ggplot2}\SpecialCharTok{::}\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Mileage vs Service Date: van\_27"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{van-analysis_files/figure-latex/cleaning van-27-1.pdf}

\hypertarget{van-data-summarization}{%
\subsection{Van Data Summarization}\label{van-data-summarization}}

This section will deal with summarizing the van-32 data.

The data will be summarized per van and per engine type.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Getting a summary for each van}
\CommentTok{\# summary\_per\_van \textless{}{-} van\_data\_32 \%\textgreater{}\%}
\CommentTok{\#   dplyr::group\_by(van, engine\_type) \%\textgreater{}\%}
\CommentTok{\#   dplyr::summarize(min\_mileage = min(mileage), max\_mileage = max(mileage),  number\_of\_service\_times = dplyr::n\_distinct(service\_date), min\_service\_cost = min(total\_cost), max\_service\_cost= max(total\_cost), average\_cost\_per\_service = mean(total\_cost), total\_service\_cost = sum(total\_cost) )}


\NormalTok{summary\_per\_van }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{((dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(van\_data\_32, van, engine\_type)), }\AttributeTok{min\_mileage =} \FunctionTok{min}\NormalTok{(mileage), }\AttributeTok{max\_mileage =} \FunctionTok{max}\NormalTok{(mileage),  }\AttributeTok{number\_of\_service\_times =}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{n}\NormalTok{(), }\AttributeTok{min\_service\_cost =} \FunctionTok{min}\NormalTok{(total\_cost), }\AttributeTok{max\_service\_cost=} \FunctionTok{max}\NormalTok{(total\_cost), }\AttributeTok{average\_cost\_per\_service =} \FunctionTok{mean}\NormalTok{(total\_cost), }\AttributeTok{total\_service\_cost =} \FunctionTok{sum}\NormalTok{(total\_cost) )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'van'. You can override using the `.groups`
## argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{View}\NormalTok{(summary\_per\_van)}
\FunctionTok{head}\NormalTok{(summary\_per\_van)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 9
## # Groups:   van [6]
##   van    engine_type  min_mileage max_mileage number_of_servic~ min_service_cost
##   <chr>  <chr>              <dbl>       <dbl>             <int>            <dbl>
## 1 van_01 TRANSIT 3.7L        4600       79500                 9             50  
## 2 van_02 E150 4.6L         208650      258500                31             36.9
## 3 van_03 GC 3.6L            45052       47052                 2            132. 
## 4 van_04 TRANSIT 3.5L          60       31000                 8             34.8
## 5 van_05 TRANSIT 3.5L          70       38888                12             34.8
## 6 van_06 GC 3.6L               36       27951                 6             85.8
## # ... with 3 more variables: max_service_cost <dbl>,
## #   average_cost_per_service <dbl>, total_service_cost <dbl>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Getting a summary for each engine }
\CommentTok{\# summary\_per\_engine \textless{}{-} van\_data\_32 \%\textgreater{}\%}
\CommentTok{\#   dplyr::group\_by(engine\_type) \%\textgreater{}\%}
\CommentTok{\#   dplyr::summarize(number\_of\_vans= dplyr::n\_distinct(van), min\_mileage = min(mileage), max\_mileage = max(mileage),  number\_of\_service\_times = dplyr::n(), service\_times\_per\_van = ceiling(dplyr::n()/dplyr::n\_distinct(van)), min\_service\_cost = min(total\_cost), max\_service\_cost= max(total\_cost), average\_cost\_per\_service = mean(total\_cost), average\_service\_cost\_per\_van = round((sum(total\_cost)/dplyr::n\_distinct(van)),2), total\_service\_cost = sum(total\_cost) )}


\NormalTok{summary\_per\_engine }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{((dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(van\_data\_32, engine\_type)), }\AttributeTok{number\_of\_vans=}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{n\_distinct}\NormalTok{(van), }\AttributeTok{min\_mileage =} \FunctionTok{min}\NormalTok{(mileage), }\AttributeTok{max\_mileage =} \FunctionTok{max}\NormalTok{(mileage),  }\AttributeTok{number\_of\_service\_times =}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{n}\NormalTok{(), }\AttributeTok{service\_times\_per\_van =} \FunctionTok{ceiling}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{n}\NormalTok{()}\SpecialCharTok{/}\NormalTok{dplyr}\SpecialCharTok{::}\FunctionTok{n\_distinct}\NormalTok{(van)), }\AttributeTok{min\_service\_cost =} \FunctionTok{min}\NormalTok{(total\_cost), }\AttributeTok{max\_service\_cost=} \FunctionTok{max}\NormalTok{(total\_cost), }\AttributeTok{average\_cost\_per\_service =} \FunctionTok{mean}\NormalTok{(total\_cost), }\AttributeTok{average\_service\_cost\_per\_van =} \FunctionTok{round}\NormalTok{((}\FunctionTok{sum}\NormalTok{(total\_cost)}\SpecialCharTok{/}\NormalTok{dplyr}\SpecialCharTok{::}\FunctionTok{n\_distinct}\NormalTok{(van)),}\DecValTok{2}\NormalTok{), }\AttributeTok{total\_service\_cost =} \FunctionTok{sum}\NormalTok{(total\_cost) )}

\FunctionTok{View}\NormalTok{(summary\_per\_engine)}
\FunctionTok{head}\NormalTok{(summary\_per\_engine)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 11
##   engine_type    number_of_vans min_mileage max_mileage number_of_service_times
##   <chr>                   <int>       <dbl>       <dbl>                   <int>
## 1 E150 4.6L                   1      208650      258500                      31
## 2 GC 3.6L                    15          36      237550                     395
## 3 PROMASTER 3.6L              8        2200      249097                     424
## 4 TRANSIT 3.5L                2          60       38888                      20
## 5 TRANSIT 3.7L                5        4600      283567                     226
## 6 VOYAGER 3.6L                1         450       35462                      10
## # ... with 6 more variables: service_times_per_van <dbl>,
## #   min_service_cost <dbl>, max_service_cost <dbl>,
## #   average_cost_per_service <dbl>, average_service_cost_per_van <dbl>,
## #   total_service_cost <dbl>
\end{verbatim}

\hypertarget{finding-cumulative-sum-for-total-cost.}{%
\subsection{Finding Cumulative Sum for Total
Cost.}\label{finding-cumulative-sum-for-total-cost.}}

Finding the cumulative sum per van, engine, and overall.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#first we sort the data according to mileage}

\NormalTok{van\_data\_final }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{arrange}\NormalTok{(van\_data\_32 ,mileage)}

\CommentTok{\#adding a column for cumulative service cost. One can use the mutate functioning the dplyr package}

\NormalTok{van\_data\_final}\SpecialCharTok{$}\NormalTok{overall\_cum\_cost }\OtherTok{=} \FunctionTok{cumsum}\NormalTok{(van\_data\_final}\SpecialCharTok{$}\NormalTok{total\_cost)}

\CommentTok{\# adding cumulative sum for each engine type}

\NormalTok{van\_data\_final }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{mutate}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(van\_data\_final, engine\_type), }\AttributeTok{cum\_cost\_per\_engine =} \FunctionTok{cumsum}\NormalTok{(total\_cost))}

\CommentTok{\#adding cumulative sum for each van}

\NormalTok{van\_data\_final }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{mutate}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(van\_data\_final, van), }\AttributeTok{cum\_cost\_per\_van =} \FunctionTok{cumsum}\NormalTok{(total\_cost))}

\FunctionTok{View}\NormalTok{(van\_data\_final)}
\FunctionTok{head}\NormalTok{(van\_data\_final)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 8
## # Groups:   van [5]
##   van    engine_type  mileage service_date        total_cost overall_cum_cost
##   <chr>  <chr>          <dbl> <dttm>                   <dbl>            <dbl>
## 1 van_06 GC 3.6L           36 2021-04-12 00:00:00     1341.             1341.
## 2 van_04 TRANSIT 3.5L      60 2021-05-28 00:00:00      578.             1920.
## 3 van_32 GC 3.6L           60 2021-05-28 00:00:00      842.             2761.
## 4 van_05 TRANSIT 3.5L      70 2021-06-18 00:00:00      681.             3442.
## 5 van_15 VOYAGER 3.6L     450 2021-09-13 00:00:00       32.5            3475.
## 6 van_32 GC 3.6L          520 2021-05-28 00:00:00       97.5            3572.
## # ... with 2 more variables: cum_cost_per_engine <dbl>, cum_cost_per_van <dbl>
\end{verbatim}

\hypertarget{data-visualization}{%
\section{Data Visualization}\label{data-visualization}}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\end{document}
